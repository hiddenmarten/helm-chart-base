vault:
  configMaps:
    files:
      data:
        "/vault/config/config.json":
          storage:
            postgresql:
              connection_url: "postgres://postgres:postgres@umbrella-postgres:5432/vault?sslmode=disable"

postgres:
  configMaps:
    files:
      data:
        "/docker-entrypoint-initdb.d/001-vault-schema.sql": |
          CREATE DATABASE vault;
          \c vault;

          CREATE TABLE vault_kv_store (
            parent_path TEXT COLLATE "C" NOT NULL,
            path        TEXT COLLATE "C",
            key         TEXT COLLATE "C",
            value       BYTEA,
            CONSTRAINT pkey PRIMARY KEY (path, key)
          );

          CREATE INDEX parent_path_idx ON vault_kv_store (parent_path);
